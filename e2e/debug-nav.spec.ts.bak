import { test, expect } from '@playwright/test';

test('Debug navigation with console logs', async ({ page }) => {
  const errors: string[] = [];
  const logs: string[] = [];

  page.on('console', msg => {
    if (msg.type() === 'error') {
      errors.push(msg.text());
    } else {
      logs.push(`[${msg.type()}] ${msg.text()}`);
    }
  });

  page.on('pageerror', error => {
    errors.push(`PAGE ERROR: ${error.message}`);
  });

  await page.goto('http://localhost:3002/');

  console.log('=== BEFORE CLICK ===');
  console.log('URL:', page.url());

  // Take screenshot before
  await page.screenshot({ path: '/tmp/before-click.png' });

  // Find and click the About link
  const aboutLink = page.locator('a[href="/about"]').first();
  console.log('About link visible:', await aboutLink.isVisible());
  console.log('About link href:', await aboutLink.getAttribute('href'));

  await aboutLink.click();
  await page.waitForTimeout(2000);

  console.log('=== AFTER CLICK ===');
  console.log('URL:', page.url());
  console.log('Errors:', errors);
  console.log('Recent logs:', logs.slice(-10));

  // Take screenshot after
  await page.screenshot({ path: '/tmp/after-click.png' });
});
